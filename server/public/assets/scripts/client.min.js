/*! personal_project 2016-05-09 */
function addDisplayDates(a){for(var b="dddd, MMMM D, h:mm a",c=0;c<a.length;c++)a[c].startDisplay=moment(a[c].start_time).format(b),a[c].endDisplay=moment(a[c].end_time).format(b);return a}var app=angular.module("childcareApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/home",{templateUrl:"views/open.html",controller:"OpenController",controllerAs:"open"}).when("/newReq",{templateUrl:"views/requestform.html",controller:"NewRequestController",controllerAs:"newReq"}).when("/open",{templateUrl:"views/open.html",controller:"OpenController",controllerAs:"open"}).when("/commitments",{templateUrl:"views/commitments.html",controller:"CommitmentController",controllerAs:"commitments"}).when("/requests",{templateUrl:"views/myrequests.html",controller:"RequestController",controllerAs:"requests"}).when("/coop",{templateUrl:"views/coop.html",controller:"CoopController",controllerAs:"coop"}),b.html5Mode(!0)}]),app.controller("IndexController",["$http",function(a){var b=this;b.getUserInfo=function(){a.get("/users/info").then(function(a){b.loggedInUser=a.data}),a.get("/coops/name").then(function(a){b.loggedInUser.coopName=a.data[0].name})},b.getUserInfo()}]),app.controller("NewRequestController",["$http",function(a){}]),app.controller("OpenController",["$http",function(a){var b=this;b.requestList=[],b.getOpenRequests=function(){a.get("/requests/open").then(function(a){b.requestList=addDisplayDates(a.data)})},b.assignRequest=function(a){$.ajax({method:"put",url:"/requests/assign",data:{request_id:a.id}}).done(function(a){b.getOpenRequests()})},b.getOpenRequests()}]),app.controller("CommitmentController",["$http",function(a){var b=this;b.requestList=[],b.getCommitments=function(){a.get("/requests/committed").then(function(a){b.requestList=addDisplayDates(a.data)})},b.markComplete=function(a){console.log("CLIENT JS"),$.ajax({method:"put",url:"/requests/complete",data:{request_id:a.id}}).done(function(a){console.log("DONE"),b.getCommitments()})},b.getCommitments()}]),app.controller("RequestController",["$http",function(a){var b=this;b.requestList=[],b.getMyRequests=function(){a.get("/requests/mine").then(function(a){b.requestList=addDisplayDates(a.data)})},b.cancel=function(a){$.ajax({method:"delete",url:"/requests/delete",data:{request_id:a}}).done(function(a){b.getMyRequests()})},b.getMyRequests()}]),app.controller("CoopController",["$http",function(a){var b=this;b.memberList=[],b.getMembers=function(){a.get("/users/coop").then(function(a){console.log(a.data),b.memberList=a.data})},b.getMembers()}]);