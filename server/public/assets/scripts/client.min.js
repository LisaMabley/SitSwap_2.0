/*! personal_project 2016-05-12 */
function addDisplayDatesToRequests(a){for(var b=0;b<a.length;b++)a[b].display_start_time=generateDisplayDate(a[b].start_time),a[b].display_end_time=generateDisplayDate(a[b].start_time);return a}function addDisplayDatesToInvitations(a){for(var b=0;b<a.length;b++)a[b].display_date=generateDisplayDate(a[b].date);return a}function generateDisplayDate(a){var b="dddd, MMMM D, h:mm a";return moment(a).format(b)}var app=angular.module("childcareApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/home",{templateUrl:"views/open.html",controller:"OpenController",controllerAs:"open"}).when("/newReq",{templateUrl:"views/requestform.html"}).when("/open",{templateUrl:"views/open.html",controller:"OpenController",controllerAs:"open"}).when("/commitments",{templateUrl:"views/commitments.html",controller:"CommitmentController",controllerAs:"commitments"}).when("/requests",{templateUrl:"views/myrequests.html",controller:"RequestController",controllerAs:"requests"}).when("/coop",{templateUrl:"views/coop.html",controller:"CoopController",controllerAs:"coop"}).when("/invite",{templateUrl:"views/invites.html",controller:"InvitationController",controllerAs:"invites"}),b.html5Mode(!0)}]),app.controller("IndexController",["$http",function(a){var b=this;b.getUserInfo=function(){a.get("/users/info").then(function(a){b.loggedInUser=a.data}),a.get("/coops/name").then(function(a){b.loggedInUser.coopName=a.data[0].name})},b.getUserInfo()}]),app.controller("OpenController",["$http",function(a){var b=this;b.requestList=[],b.getOpenRequests=function(){a.get("/requests/open").then(function(a){b.requestList=addDisplayDatesToRequests(a.data)})},b.assignRequest=function(a){$.ajax({method:"put",url:"/requests/assign",data:{request_id:a.id}}).done(function(a){b.getOpenRequests()})},b.getOpenRequests()}]),app.controller("CommitmentController",["$http",function(a){var b=this;b.requestList=[],b.getCommitments=function(){a.get("/requests/committed").then(function(a){b.requestList=addDisplayDatesToRequests(a.data)})},b.markComplete=function(a){$.ajax({method:"put",url:"/requests/complete",data:{request_id:a.id}}).done(function(a){b.getCommitments()})},b.getCommitments()}]),app.controller("RequestController",["$http",function(a){var b=this;b.requestList=[],b.getMyRequests=function(){a.get("/requests/mine").then(function(a){b.requestList=addDisplayDatesToRequests(a.data)})},b.cancel=function(a){$.ajax({method:"delete",url:"/requests/delete",data:{request_id:a}}).done(function(a){b.getMyRequests()})},b.getMyRequests()}]),app.controller("CoopController",["$http",function(a){var b=this;b.memberList=[],b.getMembers=function(){a.get("/users/coop").then(function(a){b.memberList=a.data})},b.getMembers()}]),app.controller("InvitationController",["$http",function(a){var b=this;b.inviteList=[],b.getInvitations=function(){a.get("/invitations").then(function(a){b.inviteList=addDisplayDatesToInvitations(a.data)})},b["delete"]=function(a){$.ajax({method:"delete",url:"/invitations",data:{invite_id:a.id}}).done(function(a){b.getInvitations()})},b.getInvitations()}]);